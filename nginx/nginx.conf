upstream django {
    # Сервер uWSGI будет доступен через unix-сокет.
    # Этот путь должен совпадать с путем к сокету в uwsgi.ini
    # и общим volume в docker-compose.
    server unix:///var/run/uwsgi/uwsgi.sock;
}

server {
    listen 80;
    server_name localhost;
    charset utf-8;

    client_max_body_size 75M;

    # Раздача статических файлов
    location /static/ {
        alias /var/www/static/;
    }

    # Раздача медиа-файлов
    location /media/ {
        alias /var/www/media/;
    }

    # Запросы к API перенаправляются в Django
    location /api/ {
        uwsgi_pass  django;
        include     /etc/nginx/uwsgi_params;
    }

    # Все остальные запросы, включая админку, перенаправляются в Django
    location / {
        uwsgi_pass  django;
        include     /etc/nginx/uwsgi_params;
    }
}